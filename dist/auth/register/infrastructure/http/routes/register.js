import { Router } from "express";
import { RegisterUserUseCase } from "../../../application/use-cases/User/RegisterUserUseCase.js";
import { UserRepositoryImpl } from "../../Repositories/User/MySQLUserRepository.js";
import { RegisterController } from "../controllers/register/RegisterController.js";
import { DefaultPasswordValidator } from "../../../domain/services/passwordValidator/DefaultPasswordValidator.js";
import { BlacklistedPasswords } from "../../Repositories/Password/BlacklistedPasswords.js";
import { WeakPasswordException } from "../../exceptions/Middlewares/WeakPasswordException.js";
const passwordBlacklist = new BlacklistedPasswords();
const passwordValidator = new DefaultPasswordValidator(passwordBlacklist);
const userRepository = new UserRepositoryImpl();
const registerUseCase = new RegisterUserUseCase(userRepository, passwordValidator);
const registerController = new RegisterController(registerUseCase);
export const registerRouter = Router();
registerRouter.use(WeakPasswordException);
registerRouter.post('/', registerController.register.bind(registerController));
